<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Designações</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <style>
        table{
            width: 100vw;
        }
        td{
            border: 1px solid black;
            padding: 7px;
        }
        td.semana{
            height: 20px;
            width: 100px;
        }
    </style>
</head>
<body>
    <h1>Designações trimestrais</h1>
    <table>
        <tr>
            <td></td>
            <td>Dias</td>
            
            <td>Microfone 1</td>
            <td>Microfone 2</td>
            <td>Indicador 1</td>
            <td>Indicador 2</td>
            <td>Leitura meio de semana</td>
            <td>Leitura final de semana</td>
        </tr>
       
       
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
           
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
            
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
            
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
            
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
            
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
            
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
            
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>
        <tr>
            <td class="semana">Semana </td>
            <td><input type="text" name="datepicker" class="datepicker"></td>
            
            <td><select name="microfone1"></select></td>
            <td><select name="microfone2"></select></td>
            <td><select name="indicador1"></select></td>
            <td><select name="indicador2"></select></td>
            <td><select name="leitura_meio_de_semana"></select></td>
            <td><select name="leitura_final_de_semana"></select></td>
        </tr>

      
            
    </table>

    

    <script>
         $(function() {
            // Lista de nomes
            var nomes = ["", "Renan", "Rodrigo", "Marcos", "Jailson", "Sergio", "Alexandre", "Deric", "Claudio", "Daniel", "José Carlos", "Lucas Gestoso", "Lucas Sant ana", "Raimundo", "Roberto Rangel", "Roberto Silva", "Rodrigo do Carmo"];
            var nomesExcluidosMicrofone = ["Renan", "Rodrigo", "Marcos", "Jailson", "Sergio", "Alexandre", "Deric", "Claudio"]; // Nomes a serem excluídos das colunas "Microfone 1" e "Microfone 2"
            var nomesExcluidosIndicador = ["Renan", "Rodrigo"]; // Nomes a serem excluídos das colunas "Indicador 1" e "Indicador 2"

            // Função para atualizar as opções de seleção e aplicar a lógica de desabilitação
            function atualizarOpcoesSelect(selects, nomesExcluidos) {
                selects.each(function() {
                    var select = $(this);
                    var name = select.attr("name");
                    var options = '';

                    // Adicionar todas as opções que não estão selecionadas em outras colunas e não estão na lista de nomes excluídos
                    nomes.forEach(function(nome) {
                        if (nomesExcluidos.indexOf(nome) === -1) {
                            var selectedInOtherColumn = false;
                            selects.each(function() {
                                if ($(this).attr("name") !== name && $(this).val() === nome) {
                                    selectedInOtherColumn = true;
                                    return false;
                                }
                            });
                            if (!selectedInOtherColumn) {
                                options += '<option value="' + nome + '">' + nome + '</option>';
                            }
                        }
                    });

                    // Atualizar as opções e desabilitar a opção selecionada
                    select.html(options);
                    var selectedOption = select.val();
                    select.find("option").prop("disabled", false);
                    select.find('option[value="' + selectedOption + '"]').prop("disabled", true);
                });
            }

            // Inicializar selects e adicionar evento de mudança
            var selectElements = $('select[name="microfone1"], select[name="microfone2"], select[name="indicador1"], select[name="indicador2"], select[name="leitura_meio_de_semana"], select[name="leitura_final_de_semana"]');
            atualizarOpcoesSelect(selectElements, nomesExcluidosMicrofone);
            selectElements.change(function() {
                var selectName = $(this).attr("name");
                if (selectName === "microfone1" || selectName === "microfone2") {
                    atualizarOpcoesSelect(selectElements, nomesExcluidosMicrofone);
                } else if (selectName === "indicador1" || selectName === "indicador2") {
                    atualizarOpcoesSelect(selectElements, nomesExcluidosIndicador);
                } else {
                    atualizarOpcoesSelect(selectElements, []);
                }
            });

            // Inicializar datepicker
            $(".datepicker").datepicker();
        });
      </script>
</body>
</html>